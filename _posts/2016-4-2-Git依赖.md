# Git 依赖

开发中经常遇到这样的场景:某个工作的项目包含另一个项目。这个项目可能是第三方库，也可能是开发中独立出来的模块。

Git中提供了两种方式来实现项目间的依赖

1. git submodule
2. git subtree
  
两种方式各有特点，但是由于`git submodule`设计的局限性，导致使用过程中各种坑。所以目前市场主流使用的还是`git subtree`


## git submodule



`git submodule` 和 `svn：external`属性一样，都可以实现对外包代码的引用。然而由于git的特性。两者区别还是很大。

![Alt text](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/git/gitsubmodule.png?raw=ture)


### 创建含子模块的项目 

创建一个测试项目，使用如下命令添加一个命名testModule的submodule

	$ git submodule add git@github.com:Ambtion/awesome-ios-cn.git testModule

此时，执行`git statue`,方向根目录多了两个文件（一个.gitmodules,一个testModule文件夹）
	
	$ git status
	$ 	new file:   .gitmodules
	$	new file:   testModule

差看 .gitmodules内容

	$ cat .gitmodules
	$ [submodule "testModule"]
	$ path = testModule
	$ url = git@github.com:Ambtion/awesome-ios-cn.git
	$

.gitmodules文件中记录依赖库的地址和名称。且外部依赖被copy到testModule目录下。

	git show HEAD
	commit 4bf97287152501e32fba79fb9a088462a0538448
	Author: xx <xx@gmail.com>
	add First Module
	diff --git a/.gitmodules b/.gitmodules
	new file mode 100644
	index 0000000..9a0a3f6
	--- /dev/null
	+++ b/.gitmodules
	@@ -0,0 +1,3 @@
	+[submodule "testModule"]
	+       path = testModule
	+       url = git@github.com:Ambtion/awesome-ios-cn.git
	diff --git a/testModule b/testModule
	new file mode 160000
	index 0000000..c7b1534
	--- /dev/null
	+++ b/testModule
	@@ -0,0 +1 @@
	+Subproject commit c7b15348c5690981f6ec0cec670269da95b39382

提交过程中，发现子项目的内容并没被提交，仅仅是通过`.gitmodules`+`Subproject commit`(存储在提交记录中)构成了一个`gitlink`。`.gitmodules`提供依赖地址，`Subproject commit`提供依赖的提交。


###clone含子模块的项目 

前面分析，我们知道创建含子模块的项目push到远程服务器的时候，子项目推送的是一个`gitlink`。子项目的内容并没有包含到项目的版本库中。所以clone一个含子模块的项目的时候，来下的项目中，子项目的目录是空的。

此时需要执行如下命令同步子项目库

	$ git submodule init
	$ git submodule update

`git submodule init`初始化git模块配置。修改`.git/config`，对子模块进行注册。在文件`.git/config`添加如下代码
	
	+[submodule "testModule"]
	+ url = git@github.com:Ambtion/awesome-ios-cn.git

`git submodule update`则是根据指定的地址和提交版本号`check`到指定的提交节点上。注意这里是`check`。
	

	
### 





## git subtree

## 原理

### 使用