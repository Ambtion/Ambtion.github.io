#比特币

## 背景
2008年10月31日，中本聪（化名）提出比特币的设计白皮书；2009年公布最初代码，第一个比特币与2009年1月3日18：15：05生成。2010年，比特币迎来发展的高峰；截止到目前为止，比特币已经运行了7* 25 * 10的时间，支持过单笔超过1.5亿美金的交易；

作为一种概念货币，比特币主要希望解决已有的金融货币系统的几个问题

* 被掌握在发行机构
* 自身的价值无法保证（比特币是通货缩减的)
* 无法匿名交易

要解决以上的问题，关键是要有一套强大的交易记录系统和中立的货币发行机制；首先，去中心化的分布式存储方式（区块链），保证全球范围可访问，并且都无法控制；其次，货币的发行通过比特币协议制定，总量控制，发行速度自动调整；总量一定，那么单个比特币的价格肯定随着承认比特币的实体经济的加入而水涨船高；


## 区块链

### 区块链特点
区块链技术雏形最早出现在比特币项目中。作为比特币背后的分布式记账平台，在无集中式管理的情况下，比特币网络稳定的运行了近10年时间，支持海量的交易记录，并未出现严重的漏洞。

区块链属于一种去中心化的记账技术。参与到系统的节点，可能不属于同一组织、彼此无需信任；区块链的所有节点共同维护，每个参与到区块链节点都能负责获得一分完整记录的拷贝。
与传统的记账技术相比，其特别应该包括：

*  维护一条不断增长的链，只能添加记录，而过去的记录都不可篡改
*  去中心化，无需集中控制达成共识，实现上尽量分布式
*  通过密码学集中保证交易的无法抵赖和破坏，并且尽量保护用户信息和记录的隐私性


### 区块链原理

区块链的原理理解起来不难；基本概念包括：

 * __交易__：一次操作，导致账本状态的改变，如添加一条记录
 * __区块__：记录一段时间内发生的交易和状态结果，是对当前账本状态的一次共识或者确认
 * __链__:由一个个区块按照发生顺序串联而成，是整个状态发现变化的日记记录

把区块链当初一个账本状态，每一次的交易都是试图更改一次状态，而每次共识生成的区块，就是参与者对区块中所有交易内容状态改变的结果再次确认

![blockChain](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/blocchain/blockchian.png?raw=ture)

在技术实现上，假设存在一个分布式的数据记录账本（最开始创建的叫创始块）,这个记录本只运行添加，不允许修改。结构如上图是一个线性的链表，每一个区块都是前一个的HASH基础上生成，由一个一个区块串联而成。新的数据要加入，必须放入一个新的区块。而这个区块是否合法，可以通过一些手段检测。每一个节点都可以提交一个新的区块，但是必须通过一定的共识机制对最终选择的区块达成一致。

以比特币为例；客户端发起一项交易，广播到网络中等待确认。网络中节点将等待交易记录一起打包在一起（包括前一个区块的hash等信息），组成候选区块，然后找到一个nonce串放到区块，使区块hash满足一定条件（比如小于某个值）。一旦计算出来这个区块在格式上就合法了，然后全网广播。大家拿到提案区块，发现符合预定条件，承认这个区块是合法的新区快，然后添加到链上。


## 比特币

### 比特币概念

#### 账户/地址
*  比特币账户采用非对称的加密算法；保留私钥用来证明对钱包的所有权，同时使用私钥对交易签名；交易中公开公钥，保证“挖矿”过程中对交易合法性的确认；账户没有余额概念，所以余额是在整个账本中，根据账户所参与的交易在累计叠加出来。
*  比特币的账户其实就是公钥经过一些列的hash加密（HASH160 或者SHA256，然后进行PIREMD160）及编码运算后生成的160位字符串（不直接使用公钥主要是为了避免公钥过早暴露导致被破解出私钥）


### 交易
交易是比特币功能的核心概念，在实现一条交易中如下信息：

* 付款人地址:上文提到的钱包中生成的地址
* 付款人对交易的签名确认:使用私钥对交易内容的加密，保证交易内容不被篡改
* 付款人公钥：验证交易内容未被篡改，验证交易货币的合法持有
* 付款人交易资金的来源ID:付款人这笔钱在记账本中从哪里来
* 交易金额:多少钱，与输入源的差额为交易的服务费（当然也可以把剩余输出到自己账户，也就是比特币的找零机制）
* 收款人地址:上文提到的钱包中生成的地址

交易发起后，所有的交易都会在用户之间广播，当一个网络节点接收到新的未验证的交易信息之后（可能不止一条），进行如下检查:

* 交易是否未被篡改
* 交易是否合法。包括地址是否合法、发起交易者是否是输入地址的合法拥有则、是否是UTXO(未花费过的交易输出)
* 交易的输入是否大于输出

同时将这下信息附在挖到的区块上，添加到最新的区块链节点上，发布到全网，等待全网的确认；比特币规定确认过的区块，需要在其后至少添加6个区块才能证明该区块的合法性，按照十分钟一个区块的速度，这也是为什么比特币交易至少一个小时才能确定的原因

### 挖矿

#### 记账工作

“挖矿”是参与到比特币网络的节点，通过协助生成新的区块获取比特币网络新增比特币奖励的过程；比特币每个区块最初的奖励是50个比特币，每隔21w个区块自动减半，即4年时间，最终比特币的总量会稳定在2100w个；同时需要注意的是，在挖矿的过程中，矿工可以获得交易发起者给的手续费。

当用户发生，需要有人确认交易，写到区块链中，形成新的区块。在一个相互不信任的系统中，比特币网络通过“挖矿”的方式来解决这个问题；同时考虑到多人记账导致的记账不一致问题，比特币系统引入工作量解决这个问题。规则如下：

* 一段时间（10分钟左右，同时没产出2016(大约两周)，比特币系统检测 平均时间，调整参数难度，保证10分钟的产生速率）只有一个人记账成功
* 通过工作量证明获得唯一的记账权（即最先在后面添加6个区块）
* 其他节点负责记账结果


### 工作量

每次记账的时候回把上一个块的Hash值和当前的账页信息一起作为原始信息进行Hash。


![blockChain](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/blocchain/block_lastse.png?raw=ture)

图中几个箭头如下：


1. 随机数：挖矿的过程其实就是为了找出这个数字，从而保持当前的Hash满足条件

2. 新区块比特币奖励

3. 当前区块Hash，下面详细讲

4. 上一个区块Hash

Hash值是由数字和大小写字母构成的字符串，每一位有62种可能性（可能为26个大写字母、26个小写字母，10个数字中任一个），我们可以看到区块中Hash是以18个0开头，那么要得到这个么一个数字的理论上要尝试62的18次方。这个巨大的计算量在亿亿级别。如此大的计算量需要投入大量的计算设备、电力等。这也是目前为什么挖矿成本高的原因

### 应用
目前支持比特币的两大支柱：洗钱，赌博

#### 洗钱
首先由于比特币账户的匿名特性，跟踪用户很难；
其次比特币协议支持交易过程中允许无数个进，无数个出，只要FROM的总额等于TO的总额就可以；这样在比特币交易中可以混淆无数个其他交易，从而加大排查的困难性。目前[http://blockchain.info](http://blockchain.info)这家网站提供的钱包服务的其中一项——shared address（顾名思义，共享地址，公共地址，让比特币在公共地址转一圈，黑的白的搅合一块;截止目前为止[http://blockchain.info](http://blockchain.info)上累计转账金额有400多亿美金吧，至于这里面有多少是黑的有多少是白的，其实分不清了;

#### 赌博
赌博是比特币的第二大支柱，主要是因为一个网站，[SatoshiDICE](https://satoshidice.com/)  翻译成中文叫“中本聪色子”，这个网站跟彩票类似，但是与以前各种彩票都不一样的是，他利用比特币的blockchain研制了一种算法，使得去他网站下注站方一定是无法作弊的，从算法上保证了公正性，一定不会出现双色球黑幕那种事情，所以深受赌徒们的欢迎，而他只收取交易提成。这个网站的交易金额占比特币所有交易的51%。

#### 小结
因为有洗钱和赌博这两个“刚需”在里面支撑着，比特币一时半会很难死掉，或者说二级市场上是崩溃了再拉起来，因为里面有A股庄家，他们是利益集团，会让比特币一直活跃，比特币又能做空，操控起来如鱼得水，证监会又管不到他们，所以同样的伎俩会他们可以一直玩下去。而真正使用比特币洗黑钱的人根本就是把钱兑换到比特币黑箱里面洗完了马上再兑换出来，整个过程大概不超过几分钟吧。






