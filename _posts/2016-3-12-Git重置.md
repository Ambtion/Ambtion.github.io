# Git 撤销

## 修改最后一次提交
有时候我们提交完了才发现漏掉了几个文件没有加,或者提交信息写错了。想要撤消刚才 的提交操作,可以使用 --amend 选项重新提交:
	
	$ git commit --amend

此命令相当于撤销上一次操作到缓冲区，然后将当前`缓冲区`内容作为快照提交。结果就好像就对最后一次提交的追加，修改。

## `git reset`

### 原理
git 项目中有一个 `.git/refs/heads/`的目录，该目录中存放的是以当前项目的各个分支名字命名的文件（比如 mater分支对应的master，dev分支对应的dev）。cat文件，发现文件的内容是对应分支的最新一次提交ID。这些文件描述的是当前分支的最新提交状态指向。我们称这些文件为`游标`。

`git reset`命令的实质就是修改当前分支`游标`指向，通过`git reset`我们可以任意的修改`游标`指向任何版本库中存在的`提交节点`。

值得注意的是 `git reset`是一个很危险的操作，修改`游标`指向，会导致版本库中的提交节点彻底的丢失，也意味着`git log`中提交记录的丢失。一旦修改`游标`，那么之后的提交记录在 `git log` 将无法找到。

值得欣慰的是 git 提供了一种挽救机制--`git reflog`。该命令会记录一段时间内用户的所有操作，所以特定的时间段内用户的任何操作的提交节点都是可以找到的。
默认的 git 都提供了分支日志管理功能。这是因为带有工作区的版本库都有如下设置

	git config core.logAllRefUpdates ture

### 使用
git reset 提供了两种使用方法；

	$ git reset (--patch | -p) [<tree-ish>] [--] [<paths>...]
	$ git reset [--soft | --mixed [-N] | --hard | --merge | --keep] [-q] [<commit>]

1. **命令后包含文件路径（path）**

* 	 不改变引用（`refs/heads/`文件内容
* 	 制定版本文件覆盖缓冲区文件内容，工作区内容不变。例如`git reset HARD <paths>`相当于取消之前执行`git add <path>`改变的缓冲区。

2. **命令后不包含提交版本，重置引用。根据不同的选项，可以对缓冲区或工作区重置。**

 
* `--soft` `最安全的重置`; 指定commit之后的commit回退到缓冲区;工作区保持不变。
* `--mixed` `安全次之的重置`;`默认方式`; 指定`commit`之后的`commit`回退到工作区;工作区内容不变；
* `--hard` `危险的重置`; 指定`commit`之后的`commit`全部丢弃，缓冲区，工作区和指定commit保持一致。注意：此操作，工作区，缓冲区，版本库在指定`commit`之后内容全部丢弃


## git checkout
	