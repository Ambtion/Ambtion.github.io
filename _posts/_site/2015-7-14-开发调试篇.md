# ios-开发调试

 * 使用Xcode
 * 使用LLDB
 * 使用Runtime
 * 使用[ hopper](http://www.hopperapp.com/)反汇编参看汇编或者伪代码

## Xcode Debug

 [Apple About the Debug](https://developer.apple.com/library/ios/recipes/xcode_help-debugger/articles/about_debug_area.html#//apple_ref/doc/uid/TP40009986-CH3-SW1)

 * 查看当前程序的线程
 * 查看使用内存的地址
 * 查看程序的视图页面栈
 * 模拟地理位置
 * 查看Open EL调用渲染栈

## ![Xcode Debug Area](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/lldb/Debug_Area.png)

## 使用LLDB

### LLDB 是一个有着REPL(Read Eval Print Loop) 的特性和C++，Python插件的开源调速器。

### 支持功能
 * Read   读取
 * Eval   修改变量
 * Print  输出

### 不支持功能
 * 创建新函数.block
 * 创建新class

### 功能类型
 * Debug Commands
 * User-define Commands

### 如何使用

 * 添加断点

  *![添加断点](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/lldb/Create_breakpoint.png)
  * Condition : 添加断点调节，比如 填写 “i==100”，那么当 “i==100”断点执行
  * Ignore：忽略几次断点
  * Action:添加断点行为，可以是调试器命令，shell 命令，也可以是更直接的打印 
  * Automatically continue after evaluation actions: 自动执行断点
 
 * LLDB调试命令

  * expression | e  
  
  * ![LLDB expression](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/lldb/LLDB_E.png)

   * expression 功能： 
   * 打印调试的值
   * 在调试空间生成一个临时变量
   * 改变变量的值
   * 在调试工具命名变量

  * printf | p  (call)
   'print' is an abbreviation for 'expression --'.   (print是 `expression --` 的缩写)

 * 断点控制

  *![](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/lldb/Thread_progross.png)
               *上图断点命令名称                对应LLDB命令
             *1： continue               process continue | c
             *2： step over              thread step-over | next | n | step | s
             *3： step into              thread step-in 
             *4： step  out              thread step-out
        
 * Thread return

   * 模拟函数返回，可以带上一个参数表示函数返回参数，该断点后的代码不被执行，由于破坏函数的执行，可能导致ARC机制的引用计  数出问题，导致内存泄露；

 * LLDB Demon

   * [插入一个ios私有接口的git开源库，试用LLDB中由于是Debug，我们可以通过访问一些私有接口Debug](https://github.com/Ambtion/iOS-Headers)

   * 1： 更新UI

        ` (lldb) po [[[UIApplication sharedApplication] keyWindow] recursiveDescription]`
        `<UIWindow: 0x7f82b1fa8140; frame = (0 0; 320 568); gestureRecognizers = <NSArray: 0x7f82b1fa92d0>;layer = <UIWindowLayer: 0x7f82b1fa8400>> | <UIView: 0x7f82b1d01fd0; frame = (0 0; 320 568);autoresize =   W+H; layer = <CALayer: 0x7f82b1e2e0a0>>`
        `(lldb) e id $myView = (id)0x7f82b1d01fd0`
        `(lldb) e (void)[CATransaction flush]`

   * 2: PushView
 
         `(lldb) e id $nvc = [[[UIApplication sharedApplication] keyWindow] rootViewController]`
         `(lldb) e id $vc = [UIViewController new]`
         `(lldb) e (void)[[$vc view] setBackgroundColor:[UIColor yellowColor]]`
         `(lldb) e (void)[$vc setTitle:@"Yay!"]`
         `(lldb) e (void)[$nvc pushViewContoller:$vc animated:YES]`
 
 * [Chisel](https://github.com/facebook/chisel)

    * 1：Chisel原理
        LLDB 有内建的，完整的 Python 支持。在LLDB中输入 script,会打开一个 Python REPL，我们也可以写入Python命令，运行
        自己写的Python命令。我们可以写一个Python脚本，在调起LLDB的时候，执行如下命令
        `command script import ~/myCommands.py`
        或者把这行命令放在 /.lldbinit 里，这样每次进入 LLDB 时都会自动运行

        ![man lldb](https://github.com/Ambtion/ambtion.github.io/blob/master/imageSource/lldb/ManLLDB.png)
   
    * 2：Chisel支持命令

        |Command          |Description     |iOS    |OS X   |
        |-----------------|----------------|-------|-------|
        |pviews           |Print the recursive view description for the key window.|Yes|Yes|
        |pvc              |Print the recursive view controller description for the key window.|Yes|No|
        |visualize        |Open a UIImage, CGImageRef, UIView, or CALayer in Preview.app on your Mac.|Yes|No|
        |fv               |Find a view in the hierarchy whose class name matches the provided regex.|Yes|No|
        |fvc              |Find a view controller in the hierarchy whose class name matches the provided regex.|Yes|No|
        |show/hide        |Show or hide the given view or layer. You don't even have to continue the process to see the changes!|Yes|Yes|
        |mask/unmask      |Overlay a view or layer with a transparent rectangle to visualize where it is.|Yes|No|
        |border/unborder  |Add a border to a view or layer to visualize where it is.|Yes|Yes|

        |caflush          |Flush the render server (equivalent to a "repaint" if no animations are in-flight).)|Yes|Yes|
        |bmessage         |Set a symbolic breakpoint on the method of a class or the method of an instance without worrying which class in the hierarchy actually implements the method.|Yes|Yes|
        |wivar            |Set a watchpoint on an instance variable of an object.|Yes|Yes|
        |presponder       |Print the responder chain starting from the given object.|Yes|Yes|
        |...              |... and many more!|
  
    * 3：Python自定义命令框架
      原理查考1条目或者[Chise ReadMe](https://github.com/facebook/chisel)

## 使用Runtime

###  使用Runtime跟踪函数，重写系统方法。输出Log. 推荐一个Git开源库 ： [Aspects](https://github.com/steipete/Aspects)

## 使用[ hopper](http://www.hopperapp.com/)反汇编参看汇编或者伪代码

###  我们可以反汇编
 /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/Frameworks/UIKit.framework下的二进制文件。查看系统函数调用

        
       

        
   
      



 
